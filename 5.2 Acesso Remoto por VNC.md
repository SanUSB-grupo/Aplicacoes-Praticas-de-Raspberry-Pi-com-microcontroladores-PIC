## 5.2 Acesso a um Raspberry remoto por interface gráfica

Gerenciar um Raspberry Pi (Rpi) por linhas de comando, através de interface SSH como o programa Putty, é uma forma eficiente de acesso remoto. Caso seja necessário utilizar interface gráfica, uma das melhores formas é o protocolo VNC (_Virtual Network Computing_) através do programa tightvnc.

Existem vários projetos de software que suportam VNC. O TightVNC foi escolhido porque é software livre de código aberto (GPL2) que fornece compressão para permitir que ele trabalhe sobre redes lentas de Internet e está prontamente disponível nos repositórios de software (sudo apt-get install tightvncserver). Mais detalhes em [http://sanusb.org/vnc/vncportugues.html](http://sanusb.org/vnc/vncportugues.html) .

O VNC segue o modelo cliente-servidor tradicional. O software do servidor é executado no host e software cliente é executado na máquina local que deseja controlar o host.

### 5.2.1 Instalando o software do servidor TightVNC

Primeiro é recomendável atualizar as informações do repositório de software digitando no terminal:

| **_sudo apt-get update_** |
| --- |

Instale o software do servidor a partir dos repositórios **como usuário pi (sem ser usuário root, ou seja, sem digitar sudo su)**. Se estiver como root, basta digitar _exit_ no terminal.

| **_sudo apt-get install tightvncserver_** |
| --- |

### 5.2.2 Iniciando o servidor e configurando uma senha

A primeira vez que executar o servidor digitando o código abaixo no terminal, irá pedir para definir uma senha de 8 dígitos. Esta é a senha utilizada para se conectar remotamente.

| **_/usr/bin/tightvncserver_** |
| --- |

Quando o servidor começa ele vai dizer que o desktop virtual foi configurado. Neste caso:

_New 'X' desktop is raspberrypi:1_

Mostra que o desktop é o virtual 1\. É possível se conectar a esse Desktop virtual utilizando :1 no fim do endereço IP do cliente. Este número é o que irá ser configurado para a inicialização automática depois, sendo que para inicialização automática será o Desktop virtual :2.

![1vnc](assets/1vnc.png)

Cada vez que se inicia o tightvncserver, ele captura o próximo Desktop disponível, que no nosso caso remoto automático será o 2, mas em outros casos, pode ser o 1\. Quando for requerido uma senha durante a instalação, digite uma senha de 8 dígitos no terminal como, por exemplo 12345678\. Essa senha será a mesma utilizada quando conectar no cliente Windows.

Para instalar o tightvnc no computador cliente Windows, basta baixá-lo em TightVNC.com. Após instalar o cliente Windows, aparecerá a interface da Figura 12.

![1vnc3](assets/1vnc3.png)

Figura : TightVNC.

Note que a porta VNC é 5902, ou seja, o desktop virtual instalado será o 2\. Ao clicar em Connect, basta digitar a mesma senha cadastrada na instalação no Rpi (12345678). Para modificar o Desktop virtual basta digitar **_tightvncserver_** no terminal SSH, como usuário pi, e será mostrado qual o Desktop disponível para conexão no cliente Windows;

### 5.2.3 Script de instalação automática do tightvnc para inicialização automática

Para ter a inicialização automática do tightvnc, é possível executar os seguintes passos para instalação como usuário pi (sair do modo root –> exit):

| pi@raspberrypi ~ $ **_sudo wget sanusb.org/arquivos/VncConfig.sh_** (baixar o script de instalação) |
| --- |

****

Abaixo o script _VncConfig.sh_.

| _#!/usr/bin/env bash_ |
| --- |

Para instalar manualmente basta seguir passo a passo as linhas comando abaixo:

| **_wget http://sanusb.org/vnc/tightvncserver-init.txt_** |
| --- |

A partir das linhas de comando abaixo, scripts ou arquivos binários podem ser configurados para tornar-se Default no Raspbian:

| **_sudo mv tightvncserver-init.txt /etc/init.d/tightvncserver_** |
| --- |

A variável da linha 23, que define o Desktop virtual, foi configurada como :2, ou seja, na porta 5902\. O valor original é :1

Altere o arquivo para que ele seja de propriedade root (é a propriedade padrão para arquivos de inicialização):

| **_sudo chown root:root /etc/init.d/tightvncserver_** |
| --- |

Permita que o arquivo seja executável:

| **_sudo chmod 755 /etc/init.d/tightvncserver_** |
| --- |

Adicione o comando abaixo para habilitar a execução no início do sistema operacional:

| **_sudo update-rc.d tightvncserver defaults_** |
| --- |

O TightVNC está instalado e vai ser carregado na inicialização do Raspbian. Neste momento, é recomendado a reinicialização (_reboot_) para se certificar de que está funcionando, mas é possível simplesmente parar e iniciar manualmente digitando:

| **_sudo /etc/init.d/tightvncserver stop_** |
| --- |

### 5.2.4 Mudar senha do VNC

**O VNC só aceita senha com oito caracteres, caso seja digitada uma senha com mais de oito caracteres o vnc irá considerar somente os oito primeiros.**

| **_pi@_**raspberrypi ~ $**_vncpasswd_** |
| --- |